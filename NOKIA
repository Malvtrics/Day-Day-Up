CREATE TABLE #TMP (GLOBAL_PART_NUMBER VARCHAR(20),LOCATION_CODE VARCHAR(20),[COUNT] INTEGER)
INSERT INTO #TMP 
SELECT  GLOBAL_PART_NUMBER , LOCATION_CODE , COUNT(*) AS [COUNT] FROM   GP_WS_MODIAS_QUEUE 
         GROUP BY GLOBAL_PART_NUMBER , LOCATION_CODE ORDER BY COUNT(*) DESC
CREATE TABLE #TEMP (GLOBAL_PART_NUMBER VARCHAR(20),LOCATION_CODE VARCHAR(20),[COUNT] INTEGER)
DECLARE  @Sum AS INTEGER
SET @Sum=0
WHILE @Sum <600 
BEGIN 
INSERT INTO #TEMP
SELECT TOP 1 A.GLOBAL_PART_NUMBER , A.LOCATION_CODE, A.[COUNT] FROM #TMP A LEFT JOIN #TEMP B ON  
A.GLOBAL_PART_NUMBER + A.LOCATION_CODE<>B.GLOBAL_PART_NUMBER+B.LOCATION_CODE
SET @Sum=@Sum+(SELECT TOP 1 A.[COUNT] FROM #TMP A INNER JOIN #TEMP B ON  
A.GLOBAL_PART_NUMBER+A.LOCATION_CODE <>B.GLOBAL_PART_NUMBER+ B.LOCATION_CODE)
END
--SELECT * FROM #TMP Q INNER JOIN #TEMP T ON Q.GLOBAL_PART_NUMBER=T.GLOBAL_PART_NUMBER
--AND Q.LOCATION_CODE=T.LOCATION_CODE
--GO
DROP TABLE #TMP
DROP TABLE #TEMP
