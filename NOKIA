SELECT PRICE_ID FROM 
(SELECT PRICE_ID, GLOBAL_PART_NUMBER,D.LOCATION_CODE , ROW_NUMBER() OVER (PARTITION BY PRICE_ID ORDER BY LOG_ID DESC) AS orderid
 FROM dbo.GP_WS_MODIAS_LOG_DETAIL D
 INNER JOIN GP_PRICE P
 ON P.HISTORY_FLAG = 1 AND D. IMPORTED = 'Error' AND P.PART_NUMBER = D.GLOBAL_PART_NUMBER
 AND P.LOCATION_CODE = D.LOCATION_CODE) S
WHERE S.ORDERid = 1
